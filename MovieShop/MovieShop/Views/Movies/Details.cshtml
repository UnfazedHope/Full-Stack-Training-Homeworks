@using ApplicationCore.Models.Response
@section styles {
    <style>
        .movie-details-container {
            padding: 20px;
            color: #fff;
        }

        .movie-header {
            display: flex;
            align-items: center;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .movie-info {
            padding-left: 20px;
        }

        .movie-meta {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .genres-list {
            list-style: none;
            padding: 0;
            display: flex;
            gap: 10px;
        }

        .genre-item {
            background-color: #555;
            padding: 5px 10px;
            border-radius: 5px;
        }

        .rating {
            font-size: 1.5em;
        }

        .movie-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .movie-content {
            margin-top: 20px;
        }

        .movie-facts {
            padding: 20px;
            background-color: #333;
            border-radius: 5px;
        }

            .movie-facts ul {
                list-style: none;
                padding: 0;
            }

            .movie-facts li {
                margin-bottom: 10px;
            }

        .each-cast {
            padding: 20px;
            background-color: #333;
            border-radius: 5px;
        }

        .cast-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .cast-image img {
            border-radius: 50%;
        }

        .cast-name {
            font-weight: bold;
        }

        .cast-character {
            font-style: italic;
        }

        .trailer-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            width: 80%; 
            max-width: 900px; 
            height: auto;
        }

            .trailer-popup iframe {
                width: 100%;
                height: 500px; 
            }

            .trailer-popup .close-btn {
                position: absolute;
                top: 10px;
                right: 10px;
                background: #fff;
                border: none;
                padding: 5px 10px;
                cursor: pointer;
            }
    </style>
}


@model MovieDetailsResponseModel

<div class="movie-details-container">
    <div class="row movie-header" style="background-image:url(@Model.BackdropUrl); background-position: center; background-size: cover;">
        <div class="col-3 mt-5">
            <partial name="_MovieCard" model="@Model.MovieCardResponseModel" />
        </div>
        <div class="col-6 movie-info">
            <h1>@Model.Title</h1>
            <h6>@Model.Tagline</h6>
            <div class="movie-meta">
                <span>@Model.RunTime m</span>
                <ul class="genres-list">
                    @foreach (var genre in @Model.Genres)
                    {
                        <li class="genre-item">@genre.Name</li>
                    }
                </ul>
                <span class="rating badge badge-warning">@Model.Rating</span>
            </div>
            <p class="overview">@Model.Overview</p>
        </div>
        <div class="col-3 movie-actions">
            <button type="button" class="btn btn-outline-light">REVIEW</button>
            <button type="button" class="btn btn-outline-light" onclick="showTrailerPopup()">TRAILER</button>
            <button type="button" class="btn btn-light">BUY 9.90</button>
            <button type="button" class="btn btn-light">WATCH MOVIE</button>
        </div>
    </div>

    <div class="row movie-content">
        <div class="col-3 movie-facts">
            <ul>
                <li><h4>MOVIE FACTS</h4></li>
                <li>
                    <i class='far fa-calendar-alt'></i> Release Date
                    <span class="badge badge-dark">
                        @if (Model.ReleaseDate.HasValue)
                        {
                            @Model.ReleaseDate.Value.ToString("MMM dd, yyyy")
                        }
                        else
                        {
                            @:N/A
                        }
                    </span>
                </li>
                <li>
                    Run Time
                    <span class="badge badge-dark">@Model.RunTime m</span>
                </li>
                <li>
                    Box Office
                    <span class="badge badge-dark">$$ @Model.Revenue</span>
                </li>
                <li>
                    Budget
                    <span class="badge badge-dark">$$ @Model.Budget</span>
                </li>
            </ul>
        </div>
        <div class="col-9 each-cast">
            <h4>CAST</h4>
            @foreach (var cast in @Model.Casts)
            {
                <div class="row cast-item">
                    <div class="col-2 cast-image">
                        <a asp-controller="Cast" asp-action="Details" asp-route-id="@cast.Id">
                            <img src="@cast.ProfilePath" class="img-fluid" alt="@cast.Name" />
                        </a>
                    </div>
                    <div class="col-4 cast-name">
                        <a asp-controller="Cast" asp-action="Details" asp-route-id="@cast.Id">@cast.Name</a>
                    </div>
                    <div class="col-6 cast-character">@cast.Character</div>
                </div>
            }
        </div>
    </div>
</div>

@if (Model.Trailers.Any())
{
    <div id="trailerPopup" class="trailer-popup">
        <button class="close-btn" onclick="hideTrailerPopup()">X</button>
        <div class="embed-responsive embed-responsive-16by9">
            <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/@Model.Trailers.FirstOrDefault().TrailerUrl.Split('=')[1]" allowfullscreen></iframe>
        </div>
    </div>
}

@section scripts {
    <script>
        function showTrailerPopup() {
            document.getElementById('trailerPopup').style.display = 'block';
        }

        function hideTrailerPopup() {
            document.getElementById('trailerPopup').style.display = 'none';
        }
    </script>
}

